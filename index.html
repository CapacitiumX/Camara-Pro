<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CapacitiumX Pro Cam</title>
    <style>
        :root { --accent: #007AFF; }
        body { margin: 0; background: #000; color: white; font-family: -apple-system, BlinkMacSystemFont, sans-serif; overflow: hidden; }
        
        /* Contenedor de la C√°mara */
        .camera-container { position: relative; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; }
        video { width: 100%; height: 100%; object-fit: cover; }

        /* Interfaz Nivel iPhone Pro */
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: space-between; pointer-events: none; }

        .top-bar { padding: 40px 20px; display: flex; justify-content: space-between; background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent); pointer-events: auto; }
        .mode-text { color: #FFD60A; font-weight: bold; font-size: 12px; letter-spacing: 1px; }

        .bottom-bar { padding: 40px 20px; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); pointer-events: auto; text-align: center; }

        /* Bot√≥n de Disparo */
        .shutter-container { display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
        .shutter-btn { 
            width: 70px; height: 70px; border-radius: 50%; background: white; border: 5px solid rgba(255,255,255,0.3); 
            cursor: pointer; transition: transform 0.1s; pointer-events: auto;
        }
        .shutter-btn:active { transform: scale(0.9); }

        /* Controles de Calidad */
        .controls { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; font-size: 10px; text-transform: uppercase; }
        .control-item { background: rgba(255,255,255,0.1); padding: 5px 10px; border-radius: 5px; }

        /* Galer√≠a */
        #gallery-preview { width: 45px; height: 45px; border-radius: 8px; border: 2px solid white; object-fit: cover; }

        canvas { display: none; }
    </style>
</head>
<body>

    <div class="camera-container">
        <video id="video" autoplay playsinline></video>
        
        <div class="overlay">
            <div class="top-bar">
                <div class="mode-text">RAW ‚Ä¢ PRO</div>
                <div id="status">HDR AUTO</div>
            </div>

            <div class="bottom-bar">
                <div class="controls">
                    <div class="control-item">ISO AUTO</div>
                    <div class="control-item">WB 5400K</div>
                    <div class="control-item">AF-C</div>
                </div>

                <div class="shutter-container" style="justify-content: space-around;">
                    <img id="gallery-preview" src="https://via.placeholder.com/150" alt="Preview">
                    <div class="shutter-btn" onclick="takePhoto()"></div>
                    <div style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-size: 20px;">üîÑ</div>
                </div>
                <div style="color: #FFD60A; font-size: 12px;">CAPACITIUMX S21 ULTRA SENSOR</div>
            </div>
        </div>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const preview = document.getElementById('gallery-preview');

        // Configuraci√≥n de "Nivel Dios" para el sensor del S21
        async function initCamera() {
            const constraints = {
                video: {
                    facingMode: "environment",
                    width: { ideal: 4096 }, // Forzar resoluci√≥n 4K si el navegador lo permite
                    height: { ideal: 2160 },
                    frameRate: { ideal: 60 }
                }
            };

            try {
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = stream;
            } catch (err) {
                console.error("Error al acceder a la c√°mara: ", err);
                alert("Para usar la c√°mara Pro, activa los permisos.");
            }
        }

        function takePhoto() {
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            
            // Aplicar un ligero filtro de nitidez y brillo (Nivel iPhone)
            context.filter = "contrast(1.1) saturate(1.1) brightness(1.05) sharp(1)";
            context.drawImage(video, 0, 0, canvas.width, canvas.height);

            const data = canvas.toDataURL('image/jpeg', 1.0); // Calidad m√°xima 1.0
            preview.src = data;

            // Descargar autom√°ticamente (Opcional)
            const link = document.createElement('a');
            link.download = `CAPACITIUMX_PRO_${new Date().getTime()}.jpg`;
            link.href = data;
            link.click();
        }

        initCamera();
    </script>
</body>
</html>
